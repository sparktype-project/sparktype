<!DOCTYPE html>
<html lang="en">
<head>
  {{> head headContext}}
</head>
<body class="flex min-h-screen bg-white dark:bg-slate-900"
      x-data="{
        sidebarOpen: false,
        isScrolled: false,
        expandedSections: [],
        currentPath: window.location.pathname,
        toggleSection(id) {
          if (this.expandedSections.includes(id)) {
            this.expandedSections = this.expandedSections.filter(item => item !== id);
          } else {
            this.expandedSections.push(id);
          }
        },
        normalizeUrl: function(url) {
          if (!url) return '/';
          var cleaned = url.replace(/^\.\//, '/');
          cleaned = cleaned.replace(/\/index\.html$/, '/');
          cleaned = cleaned.replace(/\/$/, '') || '/';
          return cleaned;
        },
        isActive: function(href) {
          if (!href) return false;
          var cleanHref = this.normalizeUrl(href);
          var cleanCurrent = this.normalizeUrl(this.currentPath);
          return cleanHref === cleanCurrent;
        },
        autoExpandSections: function() {
          this.expandedSections = [];
          {{#each navLinks}}
            {{#if this.children}}
              this.expandedSections.push('{{@index}}');
            {{/if}}
          {{/each}}
        },
        initScroll: function() {
          const onScroll = () => {
            this.isScrolled = window.scrollY > 0;
          };
          onScroll();
          window.addEventListener('scroll', onScroll, { passive: true });
        }
      }"
      x-init="autoExpandSections(); initScroll()">

  

  <div class="flex w-full flex-col">
    {{> header}}
    

    <div class="relative mx-auto flex w-full max-w-8xl flex-auto justify-center sm:px-2 lg:px-8">
      <div class="hidden lg:relative lg:block lg:flex-none">
        <div class="absolute inset-y-0 right-0 w-[50vw] bg-slate-50 dark:hidden"></div>
        <div class="absolute top-16 right-0 bottom-0 hidden h-12 w-px bg-gradient-to-t from-slate-800 dark:block"></div>
        <div class="absolute top-28 right-0 bottom-0 hidden w-px bg-slate-800 dark:block"></div>
        <div class="sticky top-12 -ml-0.5 h-[calc(100vh-4.75rem)] w-64 overflow-x-hidden overflow-y-auto py-16 pr-8 pl-0.5 xl:pr-8">
          {{> sidebar}}
        </div>
      </div>
      <div class="flex-auto">
        {{{body}}}
            {{> footer}}

      </div>
    </div>

  </div>

  {{!-- Mobile Sidebar --}}
  <div class="lg:hidden">
    {{!-- Backdrop --}}
    <div class="fixed inset-0 bg-black/50 backdrop-blur-lg z-40"
         x-show="sidebarOpen"
         @click="sidebarOpen = false"
         x-transition:enter="transition-opacity ease-out duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="transition-opacity ease-in duration-200"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0">
    </div>

    {{!-- Mobile sidebar panel --}}
    <div class="fixed top-0 left-0 bottom-0 w-full max-w-xs z-50 bg-white shadow-lg overflow-y-auto dark:bg-slate-900"
         x-show="sidebarOpen"
         @click.away="sidebarOpen = false"
         x-transition:enter="transition ease-out duration-300"
         x-transition:enter-start="-translate-x-full"
         x-transition:enter-end="translate-x-0"
         x-transition:leave="transition ease-in duration-200"
         x-transition:leave-start="translate-x-0"
         x-transition:leave-end="-translate-x-full">

      {{!-- Mobile header --}}
      <div class="flex items-center justify-between p-6 border-b border-slate-200 dark:border-slate-800">
        <a href="{{#if @root.options.isExport}}/index.html{{else}}/{{/if}}"
           class="flex items-center space-x-2">
          {{#if @root.headContext.logoUrl}}
            <img src="{{@root.headContext.logoUrl}}" alt="{{@root.manifest.title}} logo" class="h-9 w-auto">
          {{/if}}
          <span class="font-display font-semibold text-lg text-slate-900 dark:text-white">{{@root.manifest.title}}</span>
        </a>
        <button @click="sidebarOpen = false"
                class="p-2 text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200"
                aria-label="Close navigation">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
          </svg>
        </button>
      </div>

      {{!-- Mobile navigation --}}
      <div class="p-6">
        {{> sidebar}}
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
</body>
</html>