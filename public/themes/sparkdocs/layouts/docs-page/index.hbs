{{! layouts/docs-page/index.hbs }}

{{#if contentFile.frontmatter.banner_image}}
    <div class="mb-6 -mx-6 md:-mx-0">
        {{{image fieldname="banner_image" class="w-full h-72 object-cover rounded-lg" alt=contentFile.frontmatter.title}}}
    </div>
{{/if}}

{{! Check if TOC should be shown (hide only when explicitly set to false) }}
{{#if (eq contentFile.frontmatter.showToc false)}}
    {{! Single column layout without TOC }}
    <article class="max-w-4xl prose prose-lg">
        <h1>{{contentFile.frontmatter.title}}</h1>
        {{#if contentFile.frontmatter.description}}
            <p class="text-xl text-muted">{{contentFile.frontmatter.description}}</p>
        {{/if}}

        {{#if contentFile.frontmatter.featured_image}}
            <div class="mb-6">
                {{{image fieldname="featured_image" class="w-full rounded-lg" alt=contentFile.frontmatter.title}}}
            </div>
        {{/if}}

        {{{content}}}

        {{#if contentFile.frontmatter.layoutConfig}}
            <hr class="my-8"/>
            {{{render_collection contentFile.frontmatter.layoutConfig}}}
        {{/if}}
    </article>
{{else}}
    {{! Two-column layout with TOC (default) }}
    <div class="flex flex-col lg:flex-row gap-8">
        {{! Main content }}
        <article class="flex-1 min-w-0 prose prose-lg max-w-none">
            <h1>{{contentFile.frontmatter.title}}</h1>
            {{#if contentFile.frontmatter.description}}
                <p class="text-xl text-muted">{{contentFile.frontmatter.description}}</p>
            {{/if}}

            {{#if contentFile.frontmatter.featured_image}}
                <div class="mb-6">
                    {{{image fieldname="featured_image" class="w-full rounded-lg" alt=contentFile.frontmatter.title}}}
                </div>
            {{/if}}

            {{{content}}}

            {{#if contentFile.frontmatter.layoutConfig}}
                <hr class="my-8"/>
                {{{render_collection contentFile.frontmatter.layoutConfig}}}
            {{/if}}
        </article>

        {{! Table of Contents }}
        {{#if content}}
            {{#if (toc content minLevel=2 maxLevel=4)}}
                <aside class="hidden lg:block w-64 flex-shrink-0">
                    <div class="sticky top-24 max-h-[calc(100vh-6rem)] overflow-y-auto">
                        <h2 class="text-xs font-semibold uppercase mb-3 text-heading">On this page</h2>
                        <div class="text-sm space-y-2">
                            {{{toc_html content minLevel=2 maxLevel=4}}}
                        </div>
                    </div>
                </aside>
            {{/if}}
        {{/if}}
    </div>
{{/if}}