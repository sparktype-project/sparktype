{{!-- Unified Sidebar Navigation (mobile + desktop) --}}
<nav class="fixed left-0 top-0 bottom-0 h-full overflow-y-auto p-4 border-r border-border z-50 md:block md:relative md:z-0 md:translate-x-0"
     style="width: var(--sidebar-width, 280px); background-color: var(--color-sidebar, #ffffff);"
     x-show="sidebarOpen"
     x-transition:enter="transition ease-out duration-300 transform"
     x-transition:enter-start="-translate-x-full"
     x-transition:enter-end="translate-x-0"
     x-transition:leave="transition ease-in duration-200 transform"
     x-transition:leave-start="translate-x-0"
     x-transition:leave-end="-translate-x-full">

  {{!-- Close Button (mobile only) --}}
  <button @click="sidebarOpen = false"
          class="md:hidden  p-2 text-muted hover:text-heading transition-colors"
          aria-label="Close navigation">
    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
    </svg>
  </button>

  {{!-- Navigation Links --}}
  <div class="space-y-1 mt-12 md:mt-0 font-headings">
    {{#each navLinks}}
      {{#if this.children}}
        {{!-- Section with children --}}
        <div>
          <div class="flex items-center justify-between py-1 rounded hover:bg-muted transition-colors">
            <a href="{{this.href}}"
               class="flex-1 font-medium text-sm text-heading no-underline"
               :class="isActive('{{this.href}}') ? 'text-primary' : ''"
               @click="sidebarOpen = false">
              {{this.label}}
            </a>
            <div class="ml-2 hover:text-heading transition-all duration-200"
                    :class="expandedSections.includes('{{@index}}') ? 'rotate-90' : ''"
                    @click="toggleSection('{{@index}}')">
              <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 111.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"/>
              </svg>
            </div>
          </div>

          {{!-- Children --}}
          <div class="border-l border-solid border-border"
               x-show="expandedSections.includes('{{@index}}')"
               x-transition:enter="transition ease-out duration-200"
               x-transition:enter-start="opacity-0"
               x-transition:enter-end="opacity-100"
               x-transition:leave="transition ease-in duration-150"
               x-transition:leave-start="opacity-100"
               x-transition:leave-end="opacity-0">
            {{#each this.children}}
              <a href="{{this.href}}"
                 class="block pl-3 py-1  text-sm text-heading no-underline rounded hover:bg-muted hover:text-heading transition-colors"
                 :class="isActive('{{this.href}}') ? 'bg-opacity-10' : ''"
                 @click="sidebarOpen = false">
                {{this.label}}
              </a>
            {{/each}}
          </div>
        </div>
      {{else}}
        {{!-- Single item without children --}}
        <div>
          <a href="{{this.href}}"
             class="block py-1 font-medium text-sm text-heading no-underline rounded hover:bg-muted hover:text-primary transition-colors"
             :class="isActive('{{this.href}}') ? 'text-primary bg-primary bg-opacity-10' : ''"
             @click="sidebarOpen = false">
            {{this.label}}
          </a>
        </div>
      {{/if}}
    {{/each}}
  </div>
</nav>